<!DOCTYPE html>
<html>
 <!-- Per insertar Codi, podeu utilitzar http://hilite.me/ -->
    <head>
        <title>Caliu Fest</title>
        <link href="Styles/Style.css" rel="stylesheet" type="text/css">
        <!-- Si voleu canviar la font o algun altre paràmetre, ho podeu fer aquí, o al CSS -->
        <style>
            body {
                background-color: white;
            }
            .container {
                max-width: 1100px;
            }
            h1, h2, h3, h4, h5, p {
                color:black;
            }
            a:link {
                color:brown;
            }
            a:visited {
                color: #555a5e;
            }
            center img{
                margin: 0 auto;
                max-width: 50%;
            }
        </style>
    </head>
    <body>
        <div class="container">
            <header>
            <p>Autores: Maria Masip, Alex Torrico</p>
            </header>
                <h1>Creació d'un festival de música</h1>
		<h3>Extracció i anàlisi de dades d'Spotify </h3>
     
                <h2>Cas d'estudi</h2>
                <p>Catalunya és la seu de molts festivals de música reconeguts internacionalment, des del Sònar, el Primavera Sound, el Barcelona Beach Festival, i també de festivals de parla catalana, com el Canet Rock, l'acampada jove, el Cabró Rock, etc. <br></br>Aquest cas d'estudi, es desenvolupa en un escenari fictici on es pretén crear el cartell d'artistes per a un nou festival, que recull els grups de música més populars de la llengua catalana. A través de l'exploració de les dades extretes d'Spotify, i a partir d'unes mètriques establertes, es formalitzarà la programació, des dels caps de cartell fins als artistes convidats.<br></br>S'ha fet aquesta tria del tema, ja que representa una motivació dels dos integrants del grup, que a la vegada es podria extrapolar a un projecte a llarg termini. Ens ha semblat interessant en aquest darrer treball, no només basar el projecte en l'anàlisi de dades, sinó aplicar-les a una iniciativa que es podria esdevenir real.
</p>
               <h2>Obtenció de dades</h2> 
		<p>Per tal d'acotar el nostre estudi, s'ha focalitzat l'extracció de dades sobre la llista de reproducció oficial de música catalana, IndieCat, que recull les cançons més populars actualment. Trobem oportú realitzar-ho d'aquesta manera, ja que obtenim un primer dataset amb informació genèrica de tots els integrants de la llista de reproducció, on podrem esbrinar els gèneres, els artistes més populars del moment, les col·laboracions més destacades, etc.<br></br>A continuació, es proporciona una explicació detallada del procés d'obtenció de dades mitjançant la llibreria Spotipy de Python i com s'han recol·lectat aquestes dades de la llista de reproducció IndieCat d'Spotify.<br></br>Per aconseguir les dades de la llista de reproducció de Spotify, primer cal establir l'autenticació a través de les credencials del client de Spotify utilitzant la classe 'SpotifyClientCredentials' de la llibreria Spotipy. Aquesta classe requereix unes claus; el Client ID i el Client Secret proporcionats a la pàgina Spotify for developers, dins la plataforma.<br></p>

```python
from spotipy.oauth2 import SpotifyClientCredentials
import spotipy
import pandas as pd
 
SPOTIPY_CLIENT_ID = 'a0f97f58de884da695b1e9df20ececa9'
SPOTIPY_CLIENT_SECRET = '84668a476d394a5fbc528a22d59a92d5'
 
auth_manager = SpotifyClientCredentials(SPOTIPY_CLIENT_ID, SPOTIPY_CLIENT_SECRET)
sp = spotipy.Spotify(auth_manager=auth_manager)
```
		<p>Un cop s'estableix l'autenticació, podem utilitzar la funció 'playlist_items' per obtenir els elements que s'ubiquen dins de la llista de reproducció. En aquest cas, es fa servir l'ID de la llista de reproducció "37i9dQZF1DWZYOM6QxgTaX". Aquesta funció retorna un diccionari amb les dades dels elements de la llista de reproducció.</p>

```python
playlist = '37i9dQZF1DWZYOM6QxgTaX'
query = sp.playlist_items(playlist, fields=None, limit=100, offset=0, market=None)
```
		<p>Un cop ens trobem dins la llista de reproducció, podem iterar per cada element de la resposta per obtenir informació específica sobre cada cançó i artista. Com podem veure en l'exemple, s'aconsegueix la següent informació: el nom de la cançó, el nom de l'artista, l'ID de l'artista, la popularitat de la cançó, l'any de llançament, l'àlbum, la categoria i els gèneres de l'artista.</p>

 
```python
relacions = []
 
for i in query["items"]:
    artists = i["track"]["artists"]
 
    for artist in artists:
        source_artist_name = artist["name"]
        source_artist_id = artist["id"]
 
        track_info = sp.track(i["track"]["id"])
        track_name = track_info["name"]
        album_name = track_info["album"]["name"]
        popularity = track_info["popularity"]
        release_date = track_info["album"]["release_date"]
        category = track_info["album"]["album_type"]
 
        artist_info = sp.artist(source_artist_id)
        genres = artist_info["genres"]
 
        relacions.append({
            "Canción": track_name,
            "Artista": source_artist_name,
            "ID del Artista": source_artist_id,
            "Popularidad": popularity,
            "Año de lanzamiento": release_date,
            "Álbum": album_name,
            "Categoría": category,
            "Géneros": genres
        })
 
df = pd.DataFrame(relacions)
df.to_csv('playlist.csv', index=False)
```


<!-- Exemple de Fragment de codi generat amb http://hilite.me/ -->
                <div style="background: #272822; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #f92672">import</span> <span style="color: #f8f8f2">capturer.crawler</span> <span style="color: #66d9ef">as</span> <span style="color: #f8f8f2">c</span>
    <span style="color: #f92672">import</span> <span style="color: #f8f8f2">export</span> <span style="color: #66d9ef">as</span> <span style="color: #f8f8f2">e</span>

    <span style="color: #f8f8f2">queries</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">[</span><span style="color: #e6db74">&quot;coronavirus&quot;</span><span style="color: #f8f8f2">]</span> <span style="color: #75715e"># You can use this as a list</span>
    <span style="color: #f8f8f2">max_results</span> <span style="color: #f92672">=</span> <span style="color: #ae81ff">5</span> <span style="color: #75715e">## Nº of results in search</span>

    <span style="color: #66d9ef">def</span> <span style="color: #a6e22e">main</span><span style="color: #f8f8f2">(q,</span> <span style="color: #f8f8f2">max_results):</span>
                <span style="color: #f8f8f2">videos</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">c</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">explore_videos(q,</span> <span style="color: #f8f8f2">max_results)</span>
                <span style="color: #f8f8f2">e</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">export_data(videos,</span> <span style="color: #f8f8f2">q)</span>

    <span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">__name__</span> <span style="color: #f92672">==</span> <span style="color: #e6db74">&quot;__main__&quot;</span><span style="color: #f8f8f2">:</span>
        <span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">q</span> <span style="color: #f92672">in</span> <span style="color: #f8f8f2">queries:</span>
            <span style="color: #f8f8f2">main(q,</span> <span style="color: #f8f8f2">max_results)</span>
    </pre></div>
    <!-- Fi Fragment de codi -->
    <h2>Esto es otro subtitulo</h2>
    <p>Lorem ipsum dolor sit amet, monsectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
    <!-- Ejemplo de codigo de Grafico incrustado-->
    <div class='tableauPlaceholder' id='viz1681300013018' style='position: relative'><noscript><a href='#'><img alt='Prmedio de streamers por dia ' src='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;pr&#47;promstreamersdia&#47;Prmediodestreamerspordia&#47;1_rss.png' style='border: none' /></a></noscript><object class='tableauViz'  style='display:none;'><param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' /> <param name='embed_code_version' value='3' /> <param name='site_root' value='' /><param name='name' value='promstreamersdia&#47;Prmediodestreamerspordia' /><param name='tabs' value='no' /><param name='toolbar' value='yes' /><param name='static_image' value='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;pr&#47;promstreamersdia&#47;Prmediodestreamerspordia&#47;1.png' /> <param name='animate_transition' value='yes' /><param name='display_static_image' value='yes' /><param name='display_spinner' value='yes' /><param name='display_overlay' value='yes' /><param name='display_count' value='yes' /><param name='language' value='es-ES' /></object></div>                <script type='text/javascript'>                    var divElement = document.getElementById('viz1681300013018');                    var vizElement = divElement.getElementsByTagName('object')[0];                    vizElement.style.width='100%';vizElement.style.height=(divElement.offsetWidth*0.75)+'px';                    var scriptElement = document.createElement('script');                    scriptElement.src = 'https://public.tableau.com/javascripts/api/viz_v1.js';                    vizElement.parentNode.insertBefore(scriptElement, vizElement);                </script>
    <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
                       
            <footer>
			<hr>
			<p>
               AUTORES
            </p>

			</footer>
		</div>
	</body>
</html>
